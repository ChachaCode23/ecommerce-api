<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout :: layout(
          pageTitle='Crear Usuario',
          breadcrumb='Usuarios / Crear Nuevo',
          contentFragment=~{::content}
      )}">
<body>
<div th:fragment="content">
    <div th:replace="~{messages :: messages}"></div>

    <div style="margin-bottom: 20px;">
        <a th:href="@{/web/usuarios}" class="btn btn-secondary">
            <svg style="width: 16px; height: 16px; display: inline-block; vertical-align: middle; margin-right: 5px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
            </svg>
            Volver al Listado
        </a>
    </div>

    <h3 class="card-title">Crear Nuevo Usuario</h3>

    <form th:action="@{/web/usuarios/create}" method="post" id="formCrearUsuario">
        
        <!-- Datos del Usuario -->
        <h4 style="margin: 30px 0 20px 0; color: #374151; border-bottom: 2px solid #e5e7eb; padding-bottom: 10px;">
            üìã Datos del Usuario
        </h4>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
            <div class="form-group">
                <label for="nombre">
                    Nombre Completo <span style="color: #ef4444;">*</span>
                </label>
                <input type="text" 
                       id="nombre"
                       name="nombre" 
                       th:value="${nombre}" 
                       required
                       minlength="3"
                       maxlength="150"
                       placeholder="Ej: Juan P√©rez">
                <small style="color: #6b7280; font-size: 12px;">M√≠nimo 3 caracteres</small>
            </div>

            <div class="form-group">
                <label for="correo">
                    Correo Electr√≥nico <span style="color: #ef4444;">*</span>
                </label>
                <input type="email" 
                       id="correo"
                       name="correo" 
                       th:value="${correo}" 
                       required
                       maxlength="150"
                       placeholder="usuario@ejemplo.com">
                <small style="color: #6b7280; font-size: 12px;">Debe ser un correo v√°lido</small>
            </div>

            <div class="form-group">
                <label for="contrasena">
                    Contrase√±a <span style="color: #ef4444;">*</span>
                </label>
                <input type="password" 
                       id="contrasena"
                       name="contrasena" 
                       required
                       minlength="6"
                       maxlength="255"
                       placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                <small style="color: #6b7280; font-size: 12px;">M√≠nimo 6 caracteres</small>
            </div>

            <div class="form-group">
                <label for="rol">
                    Rol <span style="color: #ef4444;">*</span>
                </label>
                <select id="rol" name="rol" required>
                    <option value="CUSTOMER" th:selected="${rol == 'CUSTOMER' or rol == null}">Cliente (CUSTOMER)</option>
                    <option value="ADMIN" th:selected="${rol == 'ADMIN'}">Administrador (ADMIN)</option>
                </select>
                <small style="color: #6b7280; font-size: 12px;">Seleccione el tipo de usuario</small>
            </div>
        </div>

        <!-- Direcci√≥n del Usuario -->
        <h4 style="margin: 30px 0 20px 0; color: #374151; border-bottom: 2px solid #e5e7eb; padding-bottom: 10px;">
            üè† Direcci√≥n
        </h4>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
            <div class="form-group" style="grid-column: 1 / -1;">
                <label for="direccion_linea1">
                    Direcci√≥n (L√≠nea 1) <span style="color: #ef4444;">*</span>
                </label>
                <input type="text" 
                       id="direccion_linea1"
                       name="direccion_linea1" 
                       required
                       maxlength="200"
                       placeholder="Calle principal, n√∫mero">
            </div>

            <div class="form-group" style="grid-column: 1 / -1;">
                <label for="direccion_linea2">
                    Direcci√≥n (L√≠nea 2)
                </label>
                <input type="text" 
                       id="direccion_linea2"
                       name="direccion_linea2" 
                       maxlength="200"
                       placeholder="Apartamento, edificio, sector (opcional)">
            </div>

            <div class="form-group">
                <label for="direccion_ciudad">
                    Ciudad <span style="color: #ef4444;">*</span>
                </label>
                <input type="text" 
                       id="direccion_ciudad"
                       name="direccion_ciudad" 
                       required
                       maxlength="100"
                       placeholder="Ej: Santo Domingo">
            </div>

            <div class="form-group">
                <label for="direccion_provincia">
                    Provincia/Estado
                </label>
                <input type="text" 
                       id="direccion_provincia"
                       name="direccion_provincia" 
                       maxlength="100"
                       placeholder="Ej: Distrito Nacional">
            </div>

            <div class="form-group">
                <label for="direccion_codigo_postal">
                    C√≥digo Postal
                </label>
                <input type="text" 
                       id="direccion_codigo_postal"
                       name="direccion_codigo_postal" 
                       maxlength="20"
                       placeholder="Ej: 10101">
            </div>

            <div class="form-group">
                <label for="direccion_pais">
                    Pa√≠s <span style="color: #ef4444;">*</span>
                </label>
                <input type="text" 
                       id="direccion_pais"
                       name="direccion_pais" 
                       required
                       maxlength="100"
                       placeholder="Ej: Rep√∫blica Dominicana">
            </div>
        </div>

        <!-- Botones -->
        <div style="margin-top: 30px; display: flex; gap: 10px;">
            <button type="submit" class="btn btn-success" id="btnSubmit">
                <svg style="width: 16px; height: 16px; display: inline-block; vertical-align: middle; margin-right: 5px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                </svg>
                Crear Usuario
            </button>
            <a th:href="@{/web/usuarios}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>

    <script>
        let formSubmitted = false;
        document.getElementById('formCrearUsuario').addEventListener('submit', function(e) {
            if (formSubmitted) {
                e.preventDefault();
                return false;
            }
            
            formSubmitted = true;
            const submitBtn = document.getElementById('btnSubmit');
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<span style="display: inline-block; margin-right: 5px;">‚è≥</span> Creando...';
        });
    </script>

    <script th:replace="~{messages :: auto-hide-messages}"></script>
</div>
</body>
</html>